# AutoGLM æž¶æž„åˆ†æžä¸Žé‡æž„æ–¹æ¡ˆ

## ðŸ“‹ æ ¸å¿ƒå‘çŽ°

### AutoGLM (`autoglm-phone`) çš„å®žé™…èƒ½åŠ›

```
è¾“å…¥: æˆªå›¾ + ç”¨æˆ·æŒ‡ä»¤
è¾“å‡º: æ“ä½œåˆ—è¡¨ (å¯èƒ½ä¸€æ¬¡è¿”å›žå¤šæ­¥)
æ“ä½œç±»åž‹: Tap, Swipe, Type, Back, Home, Long Press, Double Tap, Wait, Take_over
```

### å½“å‰æž¶æž„é—®é¢˜

```
å½“å‰ (è¿‡äºŽå¤æ‚):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·æŒ‡ä»¤                                                      â”‚
â”‚      â†“                                                        â”‚
â”‚  Planner (glm-4-flash) â†’ ç”Ÿæˆ Python ä»£ç                      â”‚ â† å¤šä½™!
â”‚      â†“                                                        â”‚
â”‚  TaskRuntime (æ²™ç›’æ‰§è¡Œ)                                        â”‚ â† å¤šä½™!
â”‚      â†“                                                        â”‚
â”‚  step() â†’ VisionAdapter (glm-4v-flash) â†’ MicroAction â†’ Driver â”‚ â† é”™è¯¯æ¨¡åž‹!
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é—®é¢˜:
1. Planner ä½¿ç”¨ glm-4-flash ç”Ÿæˆ Python ä»£ç  - ä½† AutoGLM æœ¬èº«å°±èƒ½è§„åˆ’!
2. VisionAdapter ä½¿ç”¨ glm-4v-flash åˆ†æžæˆªå›¾ - ä½† AutoGLM æ‰æ˜¯ä¸“ç”¨æ¨¡åž‹!
3. æž¶æž„è¿‡åº¦å·¥ç¨‹åŒ–ï¼ŒAutoGLM è¢«æ”¾åœ¨äº†é”™è¯¯çš„ä½ç½®
```

### æ­£ç¡®çš„æž¶æž„

```
æ­£ç¡® (AutoGLM é—­çŽ¯):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·æŒ‡ä»¤                                   â”‚
â”‚      â†“                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  AutoGLMController                    â”‚ â”‚
â”‚  â”‚      â†“                                â”‚ â”‚
â”‚  â”‚  while not finished:                  â”‚ â”‚
â”‚  â”‚      screenshot = capture()           â”‚ â”‚
â”‚  â”‚      actions = autoglm(screenshot, instruction) â”‚
â”‚  â”‚      for action in actions:           â”‚ â”‚
â”‚  â”‚          execute(action)              â”‚ â”‚
â”‚  â”‚          wait_for_stable()            â”‚ â”‚
â”‚  â”‚      if task_finished:                â”‚ â”‚
â”‚  â”‚          break                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚      â†“                                     â”‚
â”‚  Driver (@safe_guard)                      â”‚
â”‚      â”œâ”€â”€ SerialDriver (æœºæ¢°è‡‚)             â”‚
â”‚      â””â”€â”€ WiFiDriver (ESP32-S3)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸ”§ é‡æž„æ–¹æ¡ˆ

### 1. ä¿ç•™çš„æ¨¡å—

| æ¨¡å— | åŽŸå›  |
|------|------|
| `drivers/` | ç¡¬ä»¶é©±åŠ¨å±‚å¿…éœ€ |
| `safety/` | @safe_guard å®‰å…¨æ£€æŸ¥å¿…éœ€ |
| `skills/` | æŠ€èƒ½è®°å½•ï¼ˆæ”¹ä¸ºè½¨è¿¹è®°å½•ï¼‰ |
| `utils/` | å·¥å…·å‡½æ•° |

### 2. é‡æž„çš„æ¨¡å—

| æ¨¡å— | æ”¹åŠ¨ |
|------|------|
| `brain/planner.py` | åˆ é™¤ä»£ç ç”Ÿæˆé€»è¾‘ï¼Œæ”¹ä¸ºç›´æŽ¥è°ƒç”¨ AutoGLM |
| `tactical/vision_adapter.py` | åˆ é™¤ï¼ŒåŠŸèƒ½ç”± AutoGLM æ‰¿æ‹… |
| `runtime/task_runtime.py` | ç®€åŒ–ï¼Œä¸å†æ‰§è¡Œ Python ä»£ç  |
| `runtime/micro_loop.py` | é‡æž„ä¸º AutoGLM ä¸»å¾ªçŽ¯ |

### 3. æ–°çš„æ ¸å¿ƒæŽ§åˆ¶å™¨

```python
class AutoGLMController:
    """AutoGLM ä¸»æŽ§åˆ¶å™¨ - æ›¿ä»£åŽŸæœ‰çš„å¤æ‚æž¶æž„"""
    
    def __init__(self, api_key: str, driver: BaseDriver):
        self.client = ZhipuAI(api_key=api_key)
        self.driver = driver
        self.max_loops = 20  # æœ€å¤§å¾ªçŽ¯æ¬¡æ•°ï¼ˆæ¯æ¬¡å¾ªçŽ¯å¯èƒ½æ‰§è¡Œå¤šä¸ªåŠ¨ä½œï¼‰
    
    def execute_task(self, instruction: str) -> Dict:
        """æ‰§è¡Œä»»åŠ¡ - æ ¸å¿ƒé—­çŽ¯"""
        loop_count = 0
        
        while loop_count < self.max_loops:
            loop_count += 1
            
            # 1. æˆªå›¾
            screenshot = self.driver.screenshot()
            
            # 2. è°ƒç”¨ AutoGLM
            response = self._call_autoglm(screenshot, instruction)
            
            if not response.success:
                return {'success': False, 'error': response.error}
            
            # 3. æ‰§è¡ŒåŠ¨ä½œ
            for action in response.actions:
                if action.action == 'Take_over':
                    return {'success': False, 'error': 'éœ€è¦äººå·¥æŽ¥ç®¡'}
                
                if action.action == 'Task_finished':
                    return {'success': True, 'loops': loop_count}
                
                self._execute_action(action)
                time.sleep(0.5)  # ç­‰å¾…ç•Œé¢å“åº”
        
        return {'success': False, 'error': 'è¾¾åˆ°æœ€å¤§å¾ªçŽ¯æ¬¡æ•°'}
```

## ðŸ“Š æ¨¡å—å¯¹æ¯”

### åˆ é™¤/æ›¿æ¢çš„æ¨¡å—

```
åˆ é™¤:
â”œâ”€â”€ brain/planner.py (ä»£ç ç”Ÿæˆ â†’ AutoGLM ç›´æŽ¥è§„åˆ’)
â”œâ”€â”€ tactical/vision_adapter.py (glm-4v-flash â†’ autoglm-phone)
â”œâ”€â”€ tactical/autoglm_client.py (ç§»åˆ°æ ¸å¿ƒå±‚)
â”œâ”€â”€ runtime/prompts.py (ä¸å†éœ€è¦ä»£ç ç”Ÿæˆæç¤ºè¯)
â””â”€â”€ runtime/task_runtime.py (ä¸å†æ‰§è¡Œ Python ä»£ç )

ä¿ç•™ä½†ç®€åŒ–:
â”œâ”€â”€ runtime/micro_loop.py â†’ AutoGLM ä¸»å¾ªçŽ¯
â””â”€â”€ skills/ â†’ è½¨è¿¹è®°å½•ç³»ç»Ÿ
```

### æ–°çš„æ–‡ä»¶ç»“æž„

```
semantic-agent/
â”œâ”€â”€ core/
â”‚   â””â”€â”€ autoglm_controller.py  # æ ¸å¿ƒæŽ§åˆ¶å™¨ï¼ˆæ–°ï¼‰
â”œâ”€â”€ drivers/
â”‚   â”œâ”€â”€ base_driver.py         # åŸºç±»
â”‚   â”œâ”€â”€ serial_driver.py       # ä¸²å£é©±åŠ¨
â”‚   â””â”€â”€ wifi_driver.py         # WiFi é©±åŠ¨
â”œâ”€â”€ safety/
â”‚   â””â”€â”€ layer.py               # å®‰å…¨æ£€æŸ¥
â”œâ”€â”€ skills/
â”‚   â”œâ”€â”€ trajectory.py          # è½¨è¿¹è®°å½•ï¼ˆæ›¿ä»£ä»£ç ç”Ÿæˆï¼‰
â”‚   â””â”€â”€ library.py             # æŠ€èƒ½åº“ï¼ˆå‚è€ƒç”¨ï¼‰
â””â”€â”€ utils/
    â”œâ”€â”€ config.py
    â””â”€â”€ models.py
```

## ðŸŽ¯ é‡æž„æ­¥éª¤

### æ­¥éª¤ 1: åˆ›å»ºæ ¸å¿ƒæŽ§åˆ¶å™¨
- ä»Ž `autoglm-s3-service/autoglm_client.py` æå–æ ¸å¿ƒé€»è¾‘
- å®žçŽ° `execute_task()` é—­çŽ¯

### æ­¥éª¤ 2: ç®€åŒ–é©±åŠ¨å±‚
- ä¿ç•™ `screenshot()`, `tap()`, `swipe()` ç­‰æ ¸å¿ƒæ–¹æ³•
- ç§»é™¤å¤šä½™çš„é€‚é…ä»£ç 

### æ­¥éª¤ 3: åˆ é™¤å¤šä½™æ¨¡å—
- åˆ é™¤ Planner ä»£ç ç”Ÿæˆ
- åˆ é™¤ VisionAdapter
- åˆ é™¤ TaskRuntime æ²™ç›’æ‰§è¡Œ

### æ­¥éª¤ 4: é‡æž„æŠ€èƒ½ç³»ç»Ÿ
- ä»Ž"ç”Ÿæˆä»£ç "æ”¹ä¸º"è®°å½•è½¨è¿¹"
- è½¨è¿¹ç”¨äºŽï¼š
  - ç»™ AutoGLM æä¾›ä¸Šä¸‹æ–‡å‚è€ƒ
  - åˆ†æžå¤±è´¥åŽŸå› 
  - ä¼˜åŒ–æ‰§è¡Œç­–ç•¥

## âœ… é¢„æœŸæ•ˆæžœ

1. **ç®€åŒ–**: ä»£ç é‡å‡å°‘ 60%+
2. **å‡†ç¡®**: ä½¿ç”¨ä¸“ç”¨æ¨¡åž‹ `autoglm-phone`
3. **å¯é **: æ¯æ­¥éƒ½æœ‰æˆªå›¾åé¦ˆ
4. **å¯ç»´æŠ¤**: æž¶æž„æ¸…æ™°ï¼ŒèŒè´£å•ä¸€

## ðŸ¤” è®¨è®ºç‚¹

### Q: ä¸ºä»€ä¹ˆä¸éœ€è¦ä»£ç ç”Ÿæˆï¼Ÿ

A: AutoGLM æœ¬èº«å°±æ˜¯"ç«¯åˆ°ç«¯"çš„æ‰‹æœºæŽ§åˆ¶æ¨¡åž‹ï¼š
- å®ƒå·²ç»å…·å¤‡è§†è§‰ç†è§£èƒ½åŠ›
- å®ƒå·²ç»èƒ½è¾“å‡ºç»“æž„åŒ–çš„æ“ä½œæŒ‡ä»¤
- ä¸éœ€è¦"å…ˆç”Ÿæˆä»£ç ï¼Œå†æ‰§è¡Œä»£ç "

### Q: æŠ€èƒ½ç³»ç»Ÿè¿˜æœ‰ç”¨å—ï¼Ÿ

A: æœ‰ï¼Œä½†ä½œç”¨æ”¹å˜ï¼š
- åŽŸæ¥: è’¸é¦æˆåŠŸç»éªŒä¸ºä»£ç æ¨¡æ¿
- çŽ°åœ¨: è®°å½•è½¨è¿¹ï¼Œä¾› AutoGLM å‚è€ƒæˆ–äººå·¥åˆ†æž

### Q: å®‰å…¨æ£€æŸ¥æ€Žä¹ˆåŠžï¼Ÿ

A: ä¿ç•™ `@safe_guard` è£…é¥°å™¨ï¼š
- åœ¨é©±åŠ¨å±‚æ‰§è¡Œå‰æ£€æŸ¥
- é˜²æ­¢å±é™©æ“ä½œ
- è¿™æ˜¯ç¡¬ä»¶çº§çš„ä¿æŠ¤ï¼Œä¸ä¾èµ–æ¨¡åž‹
